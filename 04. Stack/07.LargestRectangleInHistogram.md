# [84. Largest Rectangle in Histogram](https://leetcode.com/problems/largest-rectangle-in-histogram/)
Hard


Given an array of integers heights representing the histogram's bar height where the width of each bar is 1, return the area of the largest rectangle in the histogram.

 

Example 1:
```
Input: heights = [2,1,5,6,2,3]
Output: 10
Explanation: The above is a histogram where width of each bar is 1.
The largest rectangle is shown in the red area, which has an area = 10 units.
```
Example 2:
```
Input: heights = [2,4]
Output: 4
 ```

Constraints:

- 1 <= heights.length <= 105
- 0 <= heights[i] <= 104

## Approach
```
INTUITION
---------
- Each bar wants to expand left and right until a smaller bar blocks it.
- A barâ€™s maximum rectangle is known when a smaller height appears.
- When height drops, we must finalize rectangles of taller bars.

APPROACH (MONOTONIC INCREASING STACK)
------------------------------------
- Use a stack that keeps bars in increasing height order.
- Stack stores pairs: (startIndex, height).
- startIndex = farthest left this height can extend.

ALGORITHM
---------
1. Initialize:
   - maxArea = 0
   - empty stack

2. Traverse heights with index i:
   - start = i
   - While stack is not empty AND stack.top.height > heights[i]:
       - pop (index, height)
       - area = height * (i - index)
       - maxArea = max(maxArea, area)
       - start = index
   - push (start, heights[i])

3. After traversal:
   - For each (index, height) in stack:
       - area = height * (n - index)
       - maxArea = max(maxArea, area)

4. Return maxArea

WHY startIndex IS NEEDED
-----------------------
- When a taller bar is popped, the current smaller bar can extend
  as far left as that taller bar did.
- This preserves correct rectangle width.

STACK INVARIANT
---------------
- Heights in stack are always increasing.
- Each bar is pushed once and popped once.

COMPLEXITY
----------
- Time: O(n)
- Space: O(n)

ONE-LINE MEMORY HOOK
-------------------
"When height drops, finish rectangles of taller bars using stack."

```

## Solution
```java
class Solution {
    public int largestRectangleArea(int[] heights) {
        Stack<int[]>stack = new Stack<>();
        int maxArea = 0;
        int n = heights.length;

        for(int i=0; i<n; i++){
            int start = i;

            while(!stack.isEmpty() && stack.peek()[1]>heights[i]){
                int[] popped = stack.pop();
                int index = popped[0];
                int height = popped[1];
                maxArea = Math.max(maxArea, height*(i-index));
                start = index;
            }

            stack.push(new int[]{start,heights[i]});
        }

        for(int[] bar: stack){
            int height = bar[1];
            int index = bar[0];

            maxArea = Math.max(maxArea,height*(n-index));
        }

        return maxArea;
    }
}
```

## Complexity Analysis
```
- Time Complexity: O(N)
- Space Complexity: O(N)
```
